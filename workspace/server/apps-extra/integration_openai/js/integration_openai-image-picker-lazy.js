"use strict";(self.webpackChunkintegration_openai=self.webpackChunkintegration_openai||[]).push([["image-picker-lazy"],{934:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(7537),i=n.n(a),r=n(3645),o=n.n(r)()(i());o.push([t.id,".dalle-picker-content[data-v-bce0741c]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:12px 16px 16px 16px}.dalle-picker-content h2[data-v-bce0741c]{display:flex;align-items:center}.dalle-picker-content .prompts[data-v-bce0741c]{margin-top:8px;display:flex;flex-wrap:wrap;align-items:center}.dalle-picker-content .prompts>*[data-v-bce0741c]{margin-right:8px}.dalle-picker-content .prompt-bubble[data-v-bce0741c]{max-width:250px}.dalle-picker-content .spacer[data-v-bce0741c]{flex-grow:1}.dalle-picker-content .attribution[data-v-bce0741c]{color:var(--color-text-maxcontrast);padding-bottom:8px}.dalle-picker-content .input-wrapper[data-v-bce0741c]{display:flex;align-items:center;width:100%}.dalle-picker-content .prompt-select[data-v-bce0741c]{width:100%;margin-top:4px}.dalle-picker-content .footer[data-v-bce0741c]{width:100%;display:flex;align-items:center;justify-content:end;margin-top:12px}.dalle-picker-content .footer>*[data-v-bce0741c]{margin-left:4px}.dalle-picker-content .advanced[data-v-bce0741c]{width:100%;padding:12px 0}.dalle-picker-content .advanced .line[data-v-bce0741c]{display:flex;align-items:center;margin-top:8px}.dalle-picker-content .advanced .line input[data-v-bce0741c],.dalle-picker-content .advanced .line select[data-v-bce0741c]{width:200px}.dalle-picker-content .advanced input[type=number][data-v-bce0741c]{width:80px;appearance:initial !important;-moz-appearance:initial !important;-webkit-appearance:initial !important}","",{version:3,sources:["webpack://./src/views/ImageCustomPickerElement.vue"],names:[],mappings:"AACA,uCACC,UAAA,CACA,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,2BAAA,CAEA,0CACC,YAAA,CACA,kBAAA,CAGD,gDACC,cAAA,CACA,YAAA,CACA,cAAA,CACA,kBAAA,CACA,kDACC,gBAAA,CAIF,sDACC,eAAA,CAGD,+CACC,WAAA,CAGD,oDACC,mCAAA,CACA,kBAAA,CAGD,sDACC,YAAA,CACA,kBAAA,CACA,UAAA,CAGD,sDACC,UAAA,CACA,cAAA,CAGD,+CACC,UAAA,CACA,YAAA,CACA,kBAAA,CACA,mBAAA,CACA,eAAA,CACA,iDACC,eAAA,CAIF,iDACC,UAAA,CACA,cAAA,CACA,uDACC,YAAA,CACA,kBAAA,CACA,cAAA,CAEA,2HAEC,WAAA,CAIF,oEACC,UAAA,CACA,6BAAA,CACA,kCAAA,CACA,qCAAA",sourcesContent:["\n.dalle-picker-content {\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 12px 16px 16px 16px;\n\n\th2 {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.prompts {\n\t\tmargin-top: 8px;\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\talign-items: center;\n\t\t> * {\n\t\t\tmargin-right: 8px;\n\t\t}\n\t}\n\n\t.prompt-bubble {\n\t\tmax-width: 250px;\n\t}\n\n\t.spacer {\n\t\tflex-grow: 1;\n\t}\n\n\t.attribution {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\tpadding-bottom: 8px;\n\t}\n\n\t.input-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t}\n\n\t.prompt-select {\n\t\twidth: 100%;\n\t\tmargin-top: 4px;\n\t}\n\n\t.footer {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: end;\n\t\tmargin-top: 12px;\n\t\t> * {\n\t\t\tmargin-left: 4px;\n\t\t}\n\t}\n\n\t.advanced {\n\t\twidth: 100%;\n\t\tpadding: 12px 0;\n\t\t.line {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tmargin-top: 8px;\n\n\t\t\tinput,\n\t\t\tselect {\n\t\t\t\twidth: 200px;\n\t\t\t}\n\t\t}\n\n\t\tinput[type=number] {\n\t\t\twidth: 80px;\n\t\t\tappearance: initial !important;\n\t\t\t-moz-appearance: initial !important;\n\t\t\t-webkit-appearance: initial !important;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const l=o},5402:(e,n,a)=>{a.d(n,{default:()=>O});var i=a(2640),r=a(6272),o=a(9429),l=a(1585),s=a(1622),c=a(861),p=a.n(c),A=a(4192),d=a.n(A),u=a(204),m=a.n(u),g=a(6456),C=a.n(g),h=a(6122),v=a.n(h),b=a(5558),f=a(6937),x=a(9753),y=a(4024);const w={name:"ImageCustomPickerElement",components:{ImageReferenceWidget:b.default,NcButton:p(),NcLoadingIcon:d(),NcTextField:m(),NcSelect:C(),ChevronRightIcon:l.default,ChevronDownIcon:s.default,ArrowRightIcon:o.default,NcUserBubble:v(),EyeIcon:i.Z,RefreshIcon:r.Z},props:{providerId:{type:String,required:!0},accessible:{type:Boolean,default:!1}},data:()=>({query:"",loading:!1,resultUrl:null,reference:null,inputPlaceholder:t("integration_openai","cyberpunk pizza with pineapple, cats fighting with lightsabers"),poweredByTitle:t("integration_openai","by OpenAI with DALLÂ·E 2"),showAdvanced:!1,imageNumber:1,imageSize:"1024x1024",prompts:null}),computed:{showAdvancedIcon(){return this.showAdvanced?s.default:l.default},previewButtonLabel(){return null!==this.resultUrl?t("integration_openai","Regenerate"):t("integration_openai","Preview")}},watch:{},mounted(){this.focusOnInput(),this.getPromptHistory(),this.getLastImageSize()},methods:{focusOnInput(){setTimeout((()=>{this.$refs["dalle-search-input"].$el.getElementsByTagName("input")[0]?.focus()}),300)},getPromptHistory(){const t=(0,x.generateUrl)("/apps/integration_openai/prompts");return f.Z.get(t,{params:{type:0}}).then((t=>{this.prompts=t.data})).catch((t=>{console.error(t)}))},getLastImageSize(){const t=(0,x.generateUrl)("/apps/integration_openai/last-image-size");return f.Z.get(t).then((t=>{this.imageSize=t.data})).catch((t=>{console.error(t)}))},submit(){this.$emit("submit",this.resultUrl)},insertPrompt(t){void 0===this.prompts.find((e=>e.value===t))&&(console.debug("INSERT",t),this.prompts.unshift({id:0,value:t}))},generate(){if(""===this.query)return;this.loading=!0;const e={prompt:this.query,n:parseInt(this.imageNumber),size:this.imageSize},n=(0,x.generateUrl)("/apps/integration_openai/images/generations");return f.Z.post(n,e).then((e=>{const n=e.data?.hash;n&&n.length&&n.length>0?(this.resultUrl=window.location.protocol+"//"+window.location.host+(0,x.generateUrl)("/apps/integration_openai/i/{hash}",{hash:n}),this.resolveResult(),this.insertPrompt(this.query)):this.error=e.data?.error??t("integration_openai","Unknown error")})).catch((e=>{console.error("OpenAI image request error",e),(0,y.x2)(t("integration_openai","OpenAI error")+": "+(e.response?.data?.body?.error?.message||e.response?.data?.body?.error?.code||e.response?.data?.error||t("integration_openai","Unknown OpenAI API error")))})).then((()=>{this.loading=!1}))},resolveResult(){this.loading=!0,this.abortController=new AbortController,f.Z.get((0,x.generateOcsUrl)("references/resolve",2)+"?reference="+encodeURIComponent(this.resultUrl),{signal:this.abortController.signal}).then((t=>{this.reference=t.data.ocs.data.references[this.resultUrl]})).catch((t=>{console.error(t)})).then((()=>{this.loading=!1}))}}};var _=a(3379),k=a.n(_),I=a(7795),B=a.n(I),U=a(569),N=a.n(U),z=a(3565),S=a.n(z),D=a(9216),q=a.n(D),E=a(4589),P=a.n(E),R=a(934),Z={};Z.styleTagTransform=P(),Z.setAttributes=S(),Z.insert=N().bind(null,"head"),Z.domAPI=B(),Z.insertStyleElement=q();k()(R.Z,Z);R.Z&&R.Z.locals&&R.Z.locals;const O=(0,a(1900).Z)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"dalle-picker-content"},[e("h2",[t._v("\n\t\t"+t._s(t.t("integration_openai","AI image generation"))+"\n\t")]),t._v(" "),e("a",{staticClass:"attribution",attrs:{target:"_blank",href:"https://openai.com/dall-e-2/"}},[t._v("\n\t\t"+t._s(t.poweredByTitle)+"\n\t")]),t._v(" "),e("div",{staticClass:"input-wrapper"},[e("NcTextField",{ref:"dalle-search-input",attrs:{value:t.query,label:t.inputPlaceholder,disabled:t.loading,"show-trailing-button":!!t.query},on:{"update:value":function(e){t.query=e},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.generate.apply(null,arguments)},"trailing-button-click":function(e){t.query=""}}})],1),t._v(" "),null===t.reference||""===t.query?e("div",{staticClass:"prompts"},t._l(t.prompts,(function(n){return e("NcUserBubble",{key:n.id+n.value,staticClass:"prompt-bubble",attrs:{title:n.value,size:30,"avatar-image":"icon-history","display-name":n.value},on:{click:function(e){t.query=n.value}}})})),1):t._e(),t._v(" "),null!==t.reference?e("ImageReferenceWidget",{attrs:{"rich-object":t.reference.richObject,orientation:"horizontal"}}):t._e(),t._v(" "),e("div",{staticClass:"footer"},[e("NcButton",{staticClass:"advanced-button",attrs:{type:"tertiary","aria-label":t.t("integration_openai","Show/hide advanced options")},on:{click:function(e){t.showAdvanced=!t.showAdvanced}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(t.showAdvancedIcon,{tag:"component"})]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.t("integration_openai","Advanced options"))+"\n\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"secondary","aria-label":t.t("integration_openai","Preview images with OpenAI"),disabled:t.loading||!t.query},on:{click:t.generate},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon"):null!==t.resultUrl?e("RefreshIcon"):e("EyeIcon")]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.previewButtonLabel)+"\n\t\t\t")]),t._v(" "),null!==t.resultUrl?e("NcButton",{attrs:{type:"primary","aria-label":t.t("integration_openai","Submit the current preview"),disabled:t.loading},on:{click:t.submit},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowRightIcon")]},proxy:!0}],null,!1,1168934321)},[t._v("\n\t\t\t"+t._s(t.t("integration_openai","Send"))+"\n\t\t\t")]):t._e()],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showAdvanced,expression:"showAdvanced"}],staticClass:"advanced"},[e("div",{staticClass:"line"},[e("label",{attrs:{for:"number"}},[t._v("\n\t\t\t\t"+t._s(t.t("integration_openai","Number of images to generate (1-10)"))+"\n\t\t\t")]),t._v(" "),e("div",{staticClass:"spacer"}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.imageNumber,expression:"imageNumber"}],attrs:{id:"number",type:"number",min:"1",max:"10",step:"1"},domProps:{value:t.imageNumber},on:{input:function(e){e.target.composing||(t.imageNumber=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"line"},[e("label",{attrs:{for:"size"}},[t._v("\n\t\t\t\t"+t._s(t.t("integration_openai","Size of the generated images"))+"\n\t\t\t")]),t._v(" "),e("div",{staticClass:"spacer"}),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.imageSize,expression:"imageSize"}],attrs:{id:"size"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.imageSize=e.target.multiple?n:n[0]}}},[e("option",{attrs:{value:"256x256"}},[t._v("\n\t\t\t\t\t256x256 px\n\t\t\t\t")]),t._v(" "),e("option",{attrs:{value:"512x512"}},[t._v("\n\t\t\t\t\t512x512 px\n\t\t\t\t")]),t._v(" "),e("option",{attrs:{value:"1024x1024"}},[t._v("\n\t\t\t\t\t1024x1024 px\n\t\t\t\t")])])])])],1)}),[],!1,null,"bce0741c",null).exports}}]);
//# sourceMappingURL=integration_openai-image-picker-lazy.js.map?v=9f0a2260bf52017767cd